{% extends "base.html" %}

{% block title %}Pickup Requests{% endblock %}

{% block content %}
<h2>Pickup Requests</h2>

<p><a href="{{ url_for('create_pickup') }}">+ Create New Pickup</a></p>

<table border="1" cellpadding="5">
    <thead>
        <tr>
            <th>ID</th>
            <th>User</th>
            <th>Request Date</th>
            <th>Preferred Date</th>
            <th>Status</th>
            <th>Items</th>
            <th>Weight (kg)</th>
            <th>Amount ($)</th>
            <th>Staff</th>
            <th>Vehicle</th>
            <th>Facility</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for pickup in pickups %}
        <tr>
            <td>{{ pickup.pickup_id }}</td>
            <td>{{ pickup.user_name }}</td>
            <td>{{ pickup.request_date }}</td>
            <td>{{ pickup.preferred_date }}</td>
            <td><strong>{{ pickup.status }}</strong></td>
            <td>{{ pickup.item_count }}</td>
            <td>{{ "%.2f"|format(pickup.total_weight_kg or 0) }}</td>
            <td>{{ "%.2f"|format(pickup.total_amount or 0) }}</td>
            <td>{{ pickup.staff_name or '-' }}</td>
            <td>{{ pickup.vehicle_number or '-' }}</td>
            <td>{{ pickup.facility_name or '-' }}</td>
            <td>
                {% if pickup.status == 'assigned' %}
                <a href="{{ url_for('complete_collection', pickup_id=pickup.pickup_id) }}">Complete Collection</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
